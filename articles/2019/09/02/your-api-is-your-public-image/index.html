<!doctype html><html lang=en prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#"><head><base href=https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/><title>Your API is your public image | aviskase</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta property="og:title" content="Your API is your public image"><meta property="og:description" content="Disclaimer: this is a translation of the article written 2 years ago for a corporate blog. I didn&rsquo;t do a word-for-word translation because the original article went through an editor, whose style was not that close to mine. Too watered down and &ldquo;official.&rdquo; Also, some examples don&rsquo;t make sense in English."><meta name=description content="Disclaimer: this is a translation of the article written 2 years ago for a corporate blog. I didn&rsquo;t do a word-for-word translation because the original article went through an editor, whose style was not that close to mine. Too watered down and &ldquo;official.&rdquo; Also, some examples don&rsquo;t make sense in English."><meta property="og:url" content="https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/"><link rel=canonical href=https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/><meta property="og:type" content="article"><meta property="article:published_time" content="2019-09-02T00:00:00+00:00"><meta property="article:modified_time" content="2019-09-02T00:00:00+00:00"><meta property="og:site_name" content="aviskase"><meta property="article:author" content="https://www.aviskase.com/pages/about/"><meta name=generator content="Hugo 0.123.3"><link rel=stylesheet href="/css/main.min.896ab26ea71b26f2c4f733d8e195dba6b3ba658b87acfad1f9fd04db745860aa.css" integrity="sha256-iWqybqcbJvLE9zPY4ZXbprO6ZYuHrPrR+f0E23RYYKo="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="selection:bg-blue-500 selection:text-white bg-white"><div class="min-h-screen flex flex-col"><header><nav class="bg-gradient-to-b from-blue-800 to-sky-600 relative lowercase"><div class="pb-8 pt-5 md:max-w-prose lg:max-w-screen-md flex flex-wrap items-center md:items-baseline justify-between mx-6 md:mx-auto"><a class="text-amber-300 font-bold text-2xl" href=/>aviskase</a>
<input id=nav-toggle type=checkbox class="hidden peer/nav">
<label id=show-button for=nav-toggle class="flex items-center md:hidden peer-checked/nav:hidden"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" class="size-8 stroke-amber-300"><title>Menu Open</title><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/></svg>
</label><label id=hide-button for=nav-toggle class="items-center hidden peer-checked/nav:flex"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" class="size-8 stroke-amber-300"><title>Menu Close</title><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></label><ul id=nav-menu class="font-semibold text-white hidden peer-checked/nav:block md:flex mt-4 md:mt-0 space-y-2 md:space-y-0 md:space-x-8 w-full md:w-auto"><li><a href=/>Home</a></li><li><a href=/pages/about/>About</a></li><li><a href=/pages/archive/>Archive</a></li><li><a href=/feeds/all.atom.xml>RSS</a></li></ul></div><div class="absolute bottom-0 left-0 w-full overflow-hidden leading-[0] rotate-180"><svg class="relative block h-[37px] w-[calc(198%_+_1.3px)] [&>*]:fill-white" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0 0V46.29c47.79 22.2 103.59 32.17 158 28 70.36-5.37 136.33-33.31 206.8-37.5C438.64 32.43 512.34 53.67 583 72.05c69.27 18 138.3 24.88 209.4 13.08 36.15-6 69.85-17.84 104.45-29.34C989.49 25 1113-14.29 12e2 52.47V0z" opacity=".25" class=""/><path d="M0 0V15.81C13 36.92 27.64 56.86 47.69 72.05 99.41 111.27 165 111 224.58 91.58c31.15-10.15 60.09-26.07 89.67-39.8 40.92-19 84.73-46 130.83-49.67 36.26-2.85 70.9 9.42 98.6 31.56 31.77 25.39 62.32 62 103.63 73 40.44 10.79 81.35-6.69 119.13-24.28s75.16-39 116.92-43.05c59.73-5.85 113.28 22.88 168.9 38.84 30.2 8.66 59 6.17 87.09-7.5 22.43-10.89 48-26.93 60.65-49.24V0z" opacity=".5" class=""/><path d="M0 0V5.63C149.93 59 314.09 71.32 475.83 42.57c43-7.64 84.23-20.12 127.61-26.46 59-8.63 112.48 12.24 165.56 35.4C827.93 77.22 886 95.24 951.2 90c86.53-7 172.46-45.71 248.8-84.81V0z" class=""/></svg></div></nav></header><main class="flex-1 w-full px-6 md:max-w-3xl md:mx-auto lg:max-w-4xl"><div class="prose prose-slate md:mx-auto md:prose-lg md:text-center mt-12 mb-8 md:mb-12 md:mt-16"><h1>Your API is your public image</h1></div><div class="-mt-2 mb-8 md:mb-12"><div class="text-lg md:text-xl text-slate-500 flex flex-col md:flex-row md:justify-center"><div class="md:flex-1 md:text-end pb-1 md:pb-0 flex items-center space-x-2 md:justify-end"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25.0 012.25-2.25h13.5A2.25 2.25.0 0121 7.5v11.25m-18 0A2.25 2.25.0 005.25 21h13.5A2.25 2.25.0 0021 18.75m-18 0v-7.5A2.25 2.25.0 015.25 9h13.5A2.25 2.25.0 0121 11.25v7.5"/></svg>
<span>2 Sep 2019</span></div><div class="hidden md:block text-center px-3">—</div><div class="md:flex-1 text-start flex items-center space-x-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5.0A9 9 0 113 12a9 9 0 0118 0z"/></svg>
<span>7&nbsp;mins</span></div></div></div><article class="prose prose-slate md:mx-auto md:prose-lg"><p><strong>Disclaimer:</strong> this is a translation of <a href=https://quality-lab.ru/blog/your-api-is-your-public-face/ class="bg-gradient-to-b from-blue-500 to-blue-500 bg-left-bottom bg-no-repeat bg-[length:100%_0.1rem] transition-[background] duration-300 hover:bg-gradient-to-b hover:from-amber-300 hover:to-amber-300 hover:bg-[length:100%_100%]">the article</a> written 2 years ago for a corporate blog. I didn&rsquo;t do a word-for-word translation because the original article went through an editor, whose style was not that close to mine. Too watered down and &ldquo;official.&rdquo; Also, some examples don&rsquo;t make sense in English. Still, I didn&rsquo;t update it too radically. Bear in mind, at the moment of the writing I was testing SOAP services and Excel-based import/export at big government project, so most of the examples relate to that experience.</p><div class="callout note"><div class=callout-icon><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></div><p>Sometimes you&rsquo;ll see a block like that. It will contain my current thoughts on the subject or comments.</p></div><hr><p>First, what is API?</p><p><strong>API (Application Programming Interface)</strong> is an interface which helps apps to communicate with each other. Just as a human interacts with apps via buttons and dialogs (user interface, UI), so apps interact via APIs.</p><h2 id=types-of-api><a class="group relative" href=#types-of-api><span class="hidden md:group-hover:inline absolute -left-5">#</span>Types of API</a></h2><p>One way to define API types is whether it&rsquo;s public or private API. <strong>Private</strong> API is used for interactions inside your system, for example:</p><ul><li>sync between mobile or desktop app and a server</li><li>app uses server&rsquo;s computational resources (e.g., an image stylization app sends image and selected style to the server, where stylization will be done)</li><li>communications between a web app and server</li><li>communications between micro-services</li></ul><p>Primary risks for private APIs are functional and performance problems. Here, customers can only speculate why app works somehow wrong-y.</p><p>With <strong>public</strong> API communication endpoints go beyond your system boundaries. Either you use someone&rsquo;s API (social networks, maps, etc.) or you provide your API to external developers.</p><p>Let&rsquo;s talk about public APIs a bit more. For some companies providing APIs is the core business (e.g., payment processing: Stripe, Rebilly), for others it&rsquo;s just a nice to have addition to the main services. Whatever the case, public APIs open a perspective into how your internal development process works. And you won&rsquo;t be able to hide behind fancy UI and eloquent support team.</p><p>If you publish public API with bad documentation, versioning mess, and tons of functional issues, make no mistake, external developer can (and maybe should!) assume that all your system is developed is such manner. Will they build their services around <em>such</em> system and attract new users? Nope. Will they persuade their bosses and friends against using and/or buying your product? Probably. Don&rsquo;t forget that people who are not so tech-y value developers&rsquo; opinions a lot. And of course, those developers could also give your a bad reputation by complaining on social networks or forums. Therefore, before publishing even the tiniest API, you should think about its quality.</p><h2 id=four-ways-to-fuck-up-a-public-api><a class="group relative" href=#four-ways-to-fuck-up-a-public-api><span class="hidden md:group-hover:inline absolute -left-5">#</span>Four ways to fuck up a public API</a></h2><p>There are different techniques for assessing API quality (for example, <a href=http://apiux.com/2013/05/29/api-hierarchy-needs/ class="bg-gradient-to-b from-blue-500 to-blue-500 bg-left-bottom bg-no-repeat bg-[length:100%_0.1rem] transition-[background] duration-300 hover:bg-gradient-to-b hover:from-amber-300 hover:to-amber-300 hover:bg-[length:100%_100%]">hierarchy of needs</a>). Let&rsquo;s talk about four main ways to be an awful API:</p><h3 id=broken-functionality><a class="group relative" href=#broken-functionality><span class="hidden md:group-hover:inline absolute -left-5">#</span>Broken functionality</a></h3><p>Sounds banal, but a service should work. And it should provide functionality it was created for. On one of my projects, there was an embarrassing situation with an export. We tested API with different objects under various conditions, but only with the small number of objects. All was fine until we found a bug on export with lots of data. The thing is that the key purpose for this service was to provide an ability to do massive exports, therefore, the service didn&rsquo;t fulfill its main reason for existence.</p><p>You need to check available operations in context of other operations. For example, we released an import operation for objects A. It required an id of object B in the request body, but import and export of B was unreleased at the moment. As the result, it was impossible to do import A at all.</p><p>Other possible problem: do you consider a region where API will be used? Obviously, support for Cyrillic is not that important for purely US oriented product. But if you work globally, do not forget to check non-ASCII characters! Even though Unicode seems to be default, I did find bugs like that one: a user uploaded a file with the name <code>Документ_1.pdf</code>, yet it was saved as <code>_1.pdf</code>.</p><p>One more example. We had a service for chunked file download which &ldquo;ate&rdquo; last byte of the last chunk. It was highly critical problem because this service was a part of the system where these files were used as supporting documents for legal agreements.</p><h3 id=unreliability><a class="group relative" href=#unreliability><span class="hidden md:group-hover:inline absolute -left-5">#</span>Unreliability</a></h3><p>Service is reliable if it works when it&rsquo;s expected to be working and provides timely feedback in case of any problems.</p><p>Worst performance problems I encountered were with export services. One of them was working perfectly fine until the biggest organization in the system started using it and crashing application servers. Hot-fixes after hot-fixes, optimizations, new version; nothing helped. And we couldn&rsquo;t disable that service or completely rewrite its public API because of contractual obligations.</p><p>So, what if your service experiences problems? How external users will learn about it? Will there be any alert about temporary issues or downtimes? Any resolution time frames? Usually, there is a special web page with answers to these question, with a table like this:</p><p><figure><picture><source srcset=https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/api_status_hufdb7540244ef7780496cfbba1ed5434c_101541_616x279_resize_q75_h2_box_3.webp type=image/webp><img class="mx-auto rounded" src=https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/api_status.png alt="API status table" defer></picture></figure></p><p>And beware, this page should not on the same infrastructure as the services it&rsquo;s showing! It would be quite embarrassing if <a href=https://twitter.com/awscloud/status/836656664635846656 class="bg-gradient-to-b from-blue-500 to-blue-500 bg-left-bottom bg-no-repeat bg-[length:100%_0.1rem] transition-[background] duration-300 hover:bg-gradient-to-b hover:from-amber-300 hover:to-amber-300 hover:bg-[length:100%_100%]">it goes down at the same time your services go down</a>.</p><h3 id=crappy-usability><a class="group relative" href=#crappy-usability><span class="hidden md:group-hover:inline absolute -left-5">#</span>Crappy usability</a></h3><p>When we hear the word &ldquo;usability&rdquo;, we usually think about GUI: buttons and dialogs. I think GUI usability is somewhat overrated: even in the ugliest app you can guess your way by trial and error. With API it won&rsquo;t work:</p><ul><li>No public documentation? Users will never even know that API exists.</li><li>Public documentation is there, but there is no info about actual endpoints? Users won&rsquo;t be able to call API.</li><li>Public documentation is there, but written in such manner that without knowing internal docs you can&rsquo;t understand a thing? Again, users won&rsquo;t be happy at all.</li><li>Spelling mistakes? Not that critical if in text, but can be quite awful in schemes. Real support ticket:</li></ul><blockquote><p>Your developers drink too much and it impairs their accuracy. There is an epic fail in a scheme with the name of the element <code>Pressure</code>: the first letter is a Cyrillic character and it breaks all client code generation.</p></blockquote><div class="callout note"><div class=callout-icon><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></div><p>Cyrillic <code>Р/р</code> (pronounced like &ldquo;r&rdquo;) looks exactly like Latin <code>P/p</code>.</p></div><ul><li>Service works fine, but error messages are not that informative? Users won&rsquo;t understand how to fix an error (and probably will open a support ticket, so you&rsquo;ll needlessly spend time resolving non-existing issue).</li></ul><p><figure><picture><source srcset=https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/bad_error_message_hu81ce616e61ffc978cfe25a90f3ebba43_24613_565x241_resize_q75_h2_box_3.webp type=image/webp><img class="mx-auto rounded" src=https://www.aviskase.com/articles/2019/09/02/your-api-is-your-public-image/bad_error_message.png alt="Unhelpful error message" defer></picture></figure></p><ul><li><p>You have UI and API? Don&rsquo;t forget to check they correspond to each other. The most common problem is when constraints on UI fields don&rsquo;t match same fields in API: for example, UI can accept maximum 50 characters for the name and API only 20, which leads to errors when trying to export anything created on UI.</p></li><li><p>Don&rsquo;t forget about versionning (in API and its documentation). The older your services are, more careful you should be with incompatible changes. Documentation should always be up-to-date: sounds obvious, but we had a big fuck up when someone accidentally published documentation for upcoming API version and external developers started trying to use these new features, didn&rsquo;t find them, and bombed support team with &ldquo;nothing works again&rdquo; tickets.</p></li></ul><h3 id=security-holes><a class="group relative" href=#security-holes><span class="hidden md:group-hover:inline absolute -left-5">#</span>Security holes</a></h3><p>When you publish API you also increase a potential attack surface for hackers. First of all, think about authorization and authentication processes. Typically, there are special access tokens for API users. Maybe simple developers&rsquo; tokens will be enough for your case, maybe you&rsquo;ll need to use flows like OAuth. In some cases you should sign requests and responses.</p><p>Oftentimes there are several APIs: for example, test API (for internal developers and testers) and open public API. You should make sure that test API is secured enough. There are known cases when web crawlers accidentally found test endpoints and happily showed them in search results.</p><p>If you provide access to test API to external developers, you&rsquo;d better treat this API as high security risk. One time I found a stackoverflow question with code snippet containing authorization keys and proper endpoints for our system.</p><p>One open source project I used had a different issue. Test API was used by developers to help with testing: add money to the account, change account status to premium, etc. It was hidden and secure&mldr; Until someone released a version with these APIs enabled in production. That&rsquo;s bad :)</p><h2 id=conclusion><a class="group relative" href=#conclusion><span class="hidden md:group-hover:inline absolute -left-5">#</span>Conclusion</a></h2><p>After reading all of these, you&rsquo;d think that public APIs are too risky, challenging, and expensive. Perhaps, it&rsquo;s better not to provide it? Maybe. But global connectivity is a trend. Stable and useful API can facilitate your profits: it can increase your user base via external apps or advertise your workplace to professionals. It&rsquo;s a demanding work, but it pays off.</p><p>And even if you don&rsquo;t and won&rsquo;t have public API, think about your private ones. We should care about your own developers, shouldn&rsquo;t we?</p></article><div class="mx-auto max-w-max mt-16 md:text-lg"><a class="relative hover:text-blue-500 focus:text-blue-500 transition-colors duration-300" href=https://www.aviskase.com/articles/2019/08/26/revision-testers-in-this-world/ title="Revision: testers in this world"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="relative inline text-blue-500 text-xl md:text-2xl mx-2"><path d="M11 17l-5-5 5-5m7 10-5-5 5-5"/></svg>older</a>
<span class="text-blue-500 font-bold md:mx-2">&nbsp; &#183; &nbsp; &#183; &nbsp; &#183; &nbsp;</span>
<a class="relative hover:text-blue-500 focus:text-blue-500 transition-colors duration-300" href=https://www.aviskase.com/articles/2019/09/04/stereotype-rant/ title="Stereotype Rant">newer<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="relative inline text-blue-500 text-xl md:text-2xl mx-2"><path d="M13 17l5-5-5-5M6 17l5-5-5-5"/></svg></a></div></main><footer class="justify-center flex w-full mt-8 md:mt-10 pt-4 pb-3 bg-amber-300 text-sm md:text-base"><a class="border-b-2 border-transparent hover:border-blue-500" href=mailto:aviskase@gmail.com>Yuliya Bagriy</a><span>&nbsp;&#183;&nbsp;2024&nbsp;&#183;&nbsp;</span><a class="border-b-2 border-transparent hover:border-blue-500" href=https://www.aviskase.com/pages/i-dont-track-you/>No tracking</a></footer></div></body></html>