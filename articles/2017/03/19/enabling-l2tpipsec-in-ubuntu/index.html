<!doctype html><html lang=en prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#"><head><title>Enabling L2TP/IPSec in Ubuntu | aviskase</title><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta property="og:title" content="Enabling L2TP/IPSec in Ubuntu"><meta property="og:description" content="Linux is like that: you can do anything, but sometimes it&rsquo;s not easy for a common user. As for me, I hate writing config files for VPN, because network-manager is awesome. But sometimes it&rsquo;s not easy to make it work.
The biggest problem for me is LT2PT/IPSec. There is an excellent article on how to enable it using network-manager-l2tp."><meta name=description content="Linux is like that: you can do anything, but sometimes it&rsquo;s not easy for a common user. As for me, I hate writing config files for VPN, because network-manager is awesome. But sometimes it&rsquo;s not easy to make it work.
The biggest problem for me is LT2PT/IPSec. There is an excellent article on how to enable it using network-manager-l2tp."><meta property="og:url" content="https://www.aviskase.com/articles/2017/03/19/enabling-l2tpipsec-in-ubuntu/"><link rel=canonical href=https://www.aviskase.com/articles/2017/03/19/enabling-l2tpipsec-in-ubuntu/><meta property="og:type" content="article"><meta property="og:image" content="https://www.aviskase.com/site-feature.png"><meta property="og:image:height" content="630"><meta property="og:image:width" content="1200"><meta property="article:published_time" content="2017-03-19T00:00:00+00:00"><meta property="article:modified_time" content="2017-03-19T00:00:00+00:00"><meta property="og:site_name" content="aviskase"><meta property="article:author" content="https://www.aviskase.com/pages/about/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.aviskase.com/site-feature.png"><meta name=twitter:title content="Enabling L2TP/IPSec in Ubuntu"><meta name=twitter:description content="Linux is like that: you can do anything, but sometimes it&rsquo;s not easy for a common user. As for me, I hate writing config files for VPN, because network-manager is awesome. But sometimes it&rsquo;s not easy to make it work.
The biggest problem for me is LT2PT/IPSec. There is an excellent article on how to enable it using network-manager-l2tp."><meta name=twitter:site content="@aviskase"><link rel=icon href=/theme/img/favicon.ico><link rel=stylesheet href=//code.cdn.mozilla.net/fonts/fira.css><link rel=stylesheet type=text/css href=/theme/css/fontello.css><link rel=stylesheet type=text/css href=/theme/css/style.css></head><body id=index class=home><nav><ul><li><a class=site-title href=/>aviskase</a></li><li><a href=/>Blog</a></li><li><a href=/pages/about/>About</a></li><li><a href=/feeds/all.atom.xml>RSS</a></li></ul></nav><main><article><h1>Enabling L2TP/IPSec in Ubuntu</h1><div class=article-meta><time class=published>19 Mar 2017</time>
<span class=readtime><span class=icon-clock aria-hidden=true></span>1&nbsp;min</span></div><p>Linux is like that: you can do anything, but sometimes it&rsquo;s not easy for a common user. As for me, I hate writing config files for VPN, because network-manager is awesome. But sometimes it&rsquo;s not easy to make it work.</p><p>The biggest problem for me is LT2PT/IPSec. There is <a href=http://blog.z-proj.com/enabling-l2tp-over-ipsec-on-ubuntu-16-04/ class=external>an excellent article</a> on how to enable it using <code>network-manager-l2tp</code>. But as on-line articles have a tendency to be removed, I want to save these instructions here.</p><hr><p>Install the prerequisites:</p><pre><code>sudo apt install \  
intltool \  
libtool \  
network-manager-dev \  
libnm-util-dev \  
libnm-glib-dev \  
libnm-glib-vpn-dev \  
libnm-gtk-dev \  
libnm-dev \  
libnma-dev \  
ppp-dev \  
libdbus-glib-1-dev \  
libsecret-1-dev \  
libgtk-3-dev \  
libglib2.0-dev \  
xl2tpd \  
strongswan  
</code></pre><p>Get network-manager-l2tp:</p><pre><code>git clone https://github.com/nm-l2tp/network-manager-l2tp.git  
cd network-manager-l2tp  
autoreconf -fi  
intltoolize  
</code></pre><p>Configure the build:</p><pre><code>./configure \
  --disable-static --prefix=/usr \
  --sysconfdir=/etc --libdir=/usr/lib/x86_64-linux-gnu \
  --libexecdir=/usr/lib/NetworkManager \
  --localstatedir=/var \
  --with-pppd-plugin-dir=/usr/lib/pppd/2.4.7
</code></pre><p>Next:</p><pre><code>make  
sudo make install 
</code></pre><p>Remove AppArmor settings for IPSec:</p><pre><code>sudo apparmor_parser -R /etc/apparmor.d/usr.lib.ipsec.charon  
sudo apparmor_parser -R /etc/apparmor.d/usr.lib.ipsec.stroke  
</code></pre><p>Replace x2ltpd with libpcap:</p><pre><code>sudo apt remove xl2tpd  
sudo apt install libpcap0.8-dev

wget https://github.com/xelerance/xl2tpd/archive/v1.3.6/xl2tpd-1.3.6.tar.gz  
tar xvzf xl2tpd-1.3.6.tar.gz  
cd xl2tpd-1.3.6  
make  
sudo make install  
</code></pre><p>Restart your machine, profit.</p><div class="page-navigation code"><a class=prev href=https://www.aviskase.com/articles/2016/07/30/thoughts-on-the-a-word/ title="Thoughts on &#34;The 'A' Word&#34;">&larr; older</a>
<span>&nbsp; &#183; &nbsp; &#183; &nbsp; &#183; &nbsp;</span>
<a class=next href=https://www.aviskase.com/articles/2018/01/06/2018-and-mega-mind-map/ title="2018 and Mega Mind Map">newer &rarr;</a></div></article></main><footer><a href=mailto:aviskase@gmail.com>Yuliya Bagriy</a><span> &#183; 2020 &#183; </span><a href=https://www.aviskase.com/pages/i-dont-track-you/>No tracking</a></footer></body></html>